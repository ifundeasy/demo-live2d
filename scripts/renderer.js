(()=>{const{Application:e,live2d:{Live2DModel:a}}=PIXI,{Face:t,Vector:{lerp:r},Utils:{clamp:o}}=Kalidokit,i=(e=>{let a={hiyori:{key:"hiyori",name:"Hiyori",path:"hiyori_pro_en/runtime/hiyori_pro_t10.model3.json",isMale:!1,isDefault:!0},natori:{key:"natori",name:"Natori",path:"natori_pro_en/runtime/natori_pro_t06.model3.json",isMale:!0,isDefault:!0}}[new URL(window.location.href).searchParams.get("model")];return a||([a]=Object.values({hiyori:{key:"hiyori",name:"Hiyori",path:"hiyori_pro_en/runtime/hiyori_pro_t10.model3.json",isMale:!1,isDefault:!0},natori:{key:"natori",name:"Natori",path:"natori_pro_en/runtime/natori_pro_t06.model3.json",isMale:!0,isDefault:!0}}).filter((e=>e.isDefault&&e.isMale))),`assets/models/${a.path}`})();let n;const l=e=>{if(e.origin!==window.location.origin)return;const{data:{points:a,timestamp:o},origin:i,source:l}=e;if(!n||!a)return;let d;console.debug(`Apply animation with totalPoints=${a.length} sample=${JSON.stringify(a[0])}`),a&&(d=t.solve(a,{runtime:"mediapipe"}),((e,a=.7)=>{if(!n||!e)return;const{coreModel:t}=n.internalModel;n.internalModel.motionManager.update=(...o)=>{n.internalModel.eyeBlink=void 0,t.setParameterValueById("ParamEyeBallX",r(e.pupil.x,t.getParameterValueById("ParamEyeBallX"),a)),t.setParameterValueById("ParamEyeBallY",r(e.pupil.y,t.getParameterValueById("ParamEyeBallY"),a)),t.setParameterValueById("ParamAngleX",r(e.head.degrees.y,t.getParameterValueById("ParamAngleX"),a)),t.setParameterValueById("ParamAngleY",r(e.head.degrees.x,t.getParameterValueById("ParamAngleY"),a)),t.setParameterValueById("ParamAngleZ",r(e.head.degrees.z,t.getParameterValueById("ParamAngleZ"),a));const i=.66;t.setParameterValueById("ParamBodyAngleX",r(e.head.degrees.y*i,t.getParameterValueById("ParamBodyAngleX"),a)),t.setParameterValueById("ParamBodyAngleY",r(e.head.degrees.x*i,t.getParameterValueById("ParamBodyAngleY"),a)),t.setParameterValueById("ParamBodyAngleZ",r(e.head.degrees.z*i,t.getParameterValueById("ParamBodyAngleZ"),a));const l=Kalidokit.Face.stabilizeBlink({l:r(e.eye.l,t.getParameterValueById("ParamEyeLOpen"),.7),r:r(e.eye.r,t.getParameterValueById("ParamEyeROpen"),.7)},e.head.y);t.setParameterValueById("ParamEyeLOpen",l.l),t.setParameterValueById("ParamEyeROpen",l.r),t.setParameterValueById("ParamMouthOpenY",r(e.mouth.y,t.getParameterValueById("ParamMouthOpenY"),.3)),t.setParameterValueById("ParamMouthForm",.3+r(e.mouth.x,t.getParameterValueById("ParamMouthForm"),.3))}})(d,.5))};!async function(){console.log("Is Production: false");const e=new PIXI.Application({view:document.getElementById("live2d"),autoStart:!0,backgroundAlpha:0,backgroundColor:16777215,resizeTo:window});n=await a.from(i,{autoInteract:!1}),n.scale.set(.2),n.interactive=!0,n.anchor.set(.5,.5),n.position.set(.5*window.innerWidth,window.innerHeight),n.on("pointerdown",(e=>{n.offsetX=e.data.global.x-n.position.x,n.offsetY=e.data.global.y-n.position.y,n.dragging=!0})),n.on("pointerup",(e=>{n.dragging=!1})),n.on("pointermove",(e=>{n.dragging&&n.position.set(e.data.global.x-n.offsetX,e.data.global.y-n.offsetY)})),document.querySelector("#live2d").addEventListener("wheel",(e=>{e.preventDefault(),n.scale.set(o(n.scale.x+-.001*e.deltaY,-.5,10))})),e.stage.addChild(n),window.addEventListener?window.addEventListener("message",l,!1):window.attachEvent("onmessage",l)}()})();